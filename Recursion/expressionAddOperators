
#include <bits/stdc++.h>
using namespace std;

class Solution {
public:
    // DFS helper
    void dfs(const string &num, long long target, int start, long long curr_val, long long operand,
             string expression, vector<string> &ans) {

        if (start == num.size()) {
            if (curr_val == target) {
                ans.push_back(expression);
            }
            return; 
        }

        for (int i = start; i < num.size(); ++i) {
            // Leading zero rule: "0" allowed, "05" not allowed
            if (i > start && num[start] == '0') break;

            // substring num[start..i] inclusive
            string curr_num = num.substr(start, i - start + 1);
            long long val = stoll(curr_num);

            if (start == 0) {
                dfs(num, target, i + 1, val, val, curr_num, ans);
            } else {
                dfs(num, target, i + 1, curr_val + val,  val,  expression + "+" + curr_num, ans);
                dfs(num, target, i + 1,  curr_val - val,  -val, expression + "-" + curr_num, ans);
                dfs(num, target, i + 1, curr_val - operand + operand * val, operand * val, expression + "*" + curr_num, ans);
            }
        }
    }

    vector<string> addOperators(string num, int target) {
        vector<string> ans;
        dfs(num, target, 0, 0, 0, "", ans);
        return ans;
    }
};
